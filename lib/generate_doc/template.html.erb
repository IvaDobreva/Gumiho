<!DOCTYPE html>
<html>
  <head>
  
    <style>
      div.main {
      width: 1000px;
      margin: auto;}
    
      li.box {
      display: inherit;
      padding: 10px 10px;
      font-size: 14px;
      color: #1a2f43;
      margin: 0;
      background-color:#dddddd;
      border-color: black;
      border-radius: 5px;}
              
      span.method {
      background-color:#6fc717;
      padding: 10px 10px;
      border-radius: 5px;
      padding: 10px 10px;
      color: #fff;
      font-weight:bold;}
                    
      .response_box {
      display: none;
      padding: 10px;
      background-color: white;
      height: 250px;
      overflow: auto;
      border-radius: 5px;}
      
      table.params {
      border-collapse: collapse; 
      width: 100%;
      border-bottom: 1px solid #889098;}
      
      table.params td, th {border-top: 1px solid #889098;}
        
      p.failed {
      font-weight:bold;
      color: #bb132a;
      font-size: 16px;}
      
      span.method_failed {
      background-color:#bb132a;
      padding: 10px 10px;
      border-radius: 5px;
      padding: 10px 10px;
      color: #fff;
      font-weight:bold;}
      
      .requested_url {
      background-color: white;
      height: 20px;
      border-radius: 5px;
      padding: 10px;
      overflow: auto;
      display: none;}
    </style>
    
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    
    <script type="text/javascript">
      function hideResult(button) {
        $(button).hide()
      }
    
      tryMe = function(method, url, button){
        form = $(button).parent()
        inputs = form.find('input')
        
        data = {}
        
        inputs.each(function(index) {
          if(url.indexOf(':' + $(this).attr('name')) >= 0) {
            url=url.replace(':' + $(this).attr('name'), $(this).val()) 
          } else {
            data[$(this).attr('name')] = $(this).val()
          }
        })
        
        $.ajax({ type: method,
          url: url,
          data: data,
          dataType: 'json', 
          success: function(data){
            str = JSON.stringify(data, undefined, 4)
            form.find('.requested_url').html(url).css('display', 'block')
            form.find('.response_box').html(str).css('display', 'block')
            form.append('<button onclick="hideResult(this)">Hide</button>')
          }
        })
      }
      
     
    </script>
    
  </head>
  
  <body>
    <br>
      <div class="main">
        <ul>
          <%response.each do |res|%>
            <% if check_status(res[:response])== 'ok'%>
              <li class="box">
                <span class="method"><%=res[:method]%></span> 
                <span class="url"><b><%=res[:url]%> </b></span>
                <br>
                <br>
                <b>Description:</b> <%=desc = map_string(res[:response], 'data.description')%>
                <form name=<%=desc%>>
                 <table class ="params">
                   <tr>
                    <th><b>Name</b></th>
                    <th><b>Value</b></th>
                    <th><b>Type</b></th>
                    <th><b>Description</b></th>
                   </tr> 
                    <%map_array(res[:response], 'data.params') do |param_data|%>
                      <tr>
                        <td><%=name = map_string(param_data,'name')%></td>
                        <td><input type="text" name=<%=name%> ></td>
                        <td><%=map_string(param_data,'type')%></td>
                        <td><%=map_string(param_data,'description')%></td>
                      </tr>
                    <%end%>
                  </table>
                  <pre class="requested_url"></pre>
                  <pre class="response_box" ></pre>
                  <button onclick="tryMe('<%=res[:method]%>', '<%=res[:url]%>', this)" type="button">Try it out</button>
                </form>
              </li>
            <%else%>
              <li class="box">
                <span class="method_failed"><%=res[:method]%></span> 
                <span class="url"><b><%=res[:url]%> </b></span>
                <p class="failed">Request FAILED.</p>
              </li>
            <%end%>
            <br>
            <br> 
        <%end%>
      </ul>
    </div>
  </body>
</html>
